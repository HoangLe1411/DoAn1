@model List<DoAn1.Areas.Admin.Models.Product>

@{
    ViewData["Title"] = "Trang Chủ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Trangchu.css" />
}

<div class="full-background"></div>

<div class="homepage">
<div class="container mt-4">
        <!-- KHUNG NGOÀI CÙNG: bo góc + đổ bóng nhẹ -->
        <div class="outer-banner-wrapper mb-4 rounded p-3 bg-white" style="box-shadow: 0 4px 8px rgba(0,0,0,0.1);">

            <!-- KHUNG BANNER + ICON -->
            <div class="banner-section">

                <!-- Banner Carousel: bo góc và đổ bóng nhẹ -->
                <div id="mainCarousel" class="carousel slide rounded" data-bs-ride="carousel" data-bs-interval="10000" style="box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                    <div class="carousel-inner rounded">
                        <div class="carousel-item active">
                            <img src="~/images/banner1.jpg" class="d-block w-100 rounded" style="height: 280px; object-fit: cover;" alt="Banner 1">
                        </div>
                        <div class="carousel-item">
                            <img src="~/images/banner2.jpg" class="d-block w-100 rounded" style="height: 280px; object-fit: cover;" alt="Banner 2">
                        </div>
                        <div class="carousel-item">
                            <img src="~/images/banner3.jpg" class="d-block w-100 rounded" style="height: 280px; object-fit: cover;" alt="Banner 3">
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>


                <!-- Các mục icon bên dưới banner -->
                <!-- Các mục icon bên dưới banner -->
                <div class="d-flex justify-content-around text-center mt-3 px-3">

                    <!-- Yêu thích: Thêm liên kết -->
                    <a href="@Url.Action("MyWishlist", "Wishlists")" class="text-decoration-none text-dark">
                        <div class="banner-item">
                            <i class="bi bi-heart-fill text-danger fs-2"></i>
                            <p class="mt-1 mb-0">Yêu thích</p>
                        </div>
                    </a>

                    <!-- Trao đổi (tạm thời không có liên kết) -->
                    <div class="banner-item">
                        <i class="bi bi-arrow-left-right text-primary fs-2"></i>
                        <p class="mt-1 mb-0">Trao đổi</p>
                    </div>

                    <!-- Khuyến mãi (tạm thời không có liên kết) -->
                    <div class="banner-item">
                        <i class="bi bi-tag-fill text-warning fs-2"></i>
                        <p class="mt-1 mb-0">Khuyến mãi</p>
                    </div>

                </div>


            </div>
        </div>

    

    <!-- Khám phá danh mục -->
    <div class="bg-white p-3 mb-4 rounded shadow-sm">
        <h4>Khám phá danh mục</h4>
        <div class="row">
            <div class="col text-center">
                <a href="/Products/AllProducts" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_all.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Tất cả</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="2" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_thoitrang.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Thời trang</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="1" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_dogiadung.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Đồ gia dụng</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="3" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_dientu.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Đồ điện tử</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="5" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_mebe.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Mẹ & Bé</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="4" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_xeco.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Xe cộ</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="6" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_sach.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Sách</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="8" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_thethaogiai_tri.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Thể thao</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="7" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_vanphongpham.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Văn phòng</p>
                    </div>
                </a>
            </div>
            <div class="col text-center">
                <a asp-controller="Products" asp-action="ByCategory" asp-route-categoryId="9" class="category-link">
                    <div class="category-item">
                        <img src="~/images/category_khac.png" class="img-fluid mb-2" style="height: 60px;">
                        <p>Khác</p>
                    </div>
                </a>
            </div>
        </div>
    </div>


    <!-- Tin đăng mới -->
        <!-- Tin đăng mới -->
        <div class="bg-white p-3 mb-4 rounded shadow-sm">
            <h4>Tin đăng mới</h4>
            <div class="row">
                @foreach (var product in Model.Take(6))
                {
                    var imageUrl = product.ProductImages?.FirstOrDefault()?.ImageUrl ?? "/images/no-image.png";
                    <div class="col-md-4 mb-3">
                        <div class="card shadow-sm h-100">
                            <a asp-controller="Products" asp-action="DetailProduct" asp-route-id="@product.ProductId">
                                <img src="@imageUrl" class="card-img-top" style="height: 200px; object-fit: cover;"
                                     onerror="this.onerror=null;this.src='/images/no-image.png';" />
                            </a>

                            <div class="card-body">
                                <h5 class="card-title text-truncate">@product.Title</h5>
                                <p class="card-text text-danger fw-bold">@string.Format("{0:N0} đ", product.Price)</p>
                                <p class="card-text"><i class="bi bi-geo-alt"></i> @product.Location</p>
                                <a asp-controller="Products" asp-action="DetailProduct" asp-route-id="@product.ProductId"
                                   class="btn btn-outline-primary w-100 mt-2">Xem chi tiết</a>
                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>


    <!-- Sản phẩm nổi bật -->
        <!-- Sản phẩm nổi bật -->
        <div class="bg-white p-3 mb-4 rounded shadow-sm">
            <div class="row">
                @{
                    var featuredProducts = ViewBag.FeaturedProducts as List<DoAn1.Areas.Admin.Models.Product>;
                }

                @if (featuredProducts != null && featuredProducts.Any())
                {
                    <div class="bg-white p-3 mb-4 rounded shadow-sm">
                        <h4 class="mb-3">🔥 Sản phẩm nổi bật</h4>
                        <div class="row">
                            @foreach (var product in featuredProducts)
                            {
                                var avg = (product.RatingCount ?? 0) > 0
                                ? ((double)(product.TotalRating ?? 0) / (product.RatingCount ?? 1))
                                : 0;

                                <div class="col-md-3 mb-3">
                                    <div class="card h-100">
                                        <img src="@(product.ProductImages?.FirstOrDefault()?.ImageUrl ?? "/images/no-image.png")"
                                             class="card-img-top" style="height: 200px; object-fit: cover;" />
                                        <div class="card-body d-flex flex-column">
                                            <h5 class="card-title">@product.Title</h5>
                                            <p class="card-text text-danger">@product.Price?.ToString("N0") ₫</p>
                                            <p>⭐ @avg.ToString("0.0")/5 (@product.RatingCount đánh giá)</p>
                                            <a asp-action="DetailProduct" asp-controller="Products" asp-route-id="@product.ProductId"
                                               class="btn btn-outline-primary mt-auto">Xem chi tiết</a>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                }
                else
                {
                    <p class="text-muted">Không có sản phẩm nổi bật.</p>
                }
            </div>
        </div>


</div>
</div>